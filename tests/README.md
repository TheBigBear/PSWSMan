# Testing for PSWSMan

As testing PSWSMan requires a Windows host to talk to it is hard to test all the various edge cases and scenarios through CI.
This document is designed to walk through the integration test setup to run the full suite of tests against on the current host.
The test environment to create the WinRM server and domain environment is provided by [wsman-environment](https://github.com/jborean93/wsman-environment).

On macOS, the CA certificate generated by `wsman-environment` needs to be loaded in the system trust store.
This can be done using the following commands to load the CA cert at the `~/ca.pem` path.

```bash
sudo security authorizationdb read com.apple.trust-settings.admin > rights
sudo security authorizationdb write com.apple.trust-settings.admin allow
sudo security add-trusted-cert -d -r trustRoot -k /Library/Keychains/System.keychain ~/ca.pem
sudo security authorizationdb write com.apple.trust-settings.admin < rights
```

Once the tests are completed the certificate can be removed from the `Keychain Access` application.
